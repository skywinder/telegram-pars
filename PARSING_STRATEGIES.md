# Стратегии парсинга Telegram Parser

## Текущие режимы работы

### 1. **Умное кэширование (по умолчанию)**
- При парсинге чата сначала проверяется наличие кэшированных сообщений в БД
- Если сообщения есть, парсятся только новые сообщения с последней сохраненной даты
- Это значительно экономит время и API запросы
- Используется при обычном запуске парсинга

### 2. **Полное сканирование (force_full_scan)**
- Игнорирует кэш и парсит все доступные сообщения
- Используется для проверки изменений в старых сообщениях
- Активируется при проверке изменений или по запросу

### 3. **Проверка изменений**
- Специальный режим для обнаружения отредактированных и удаленных сообщений
- Сравнивает текущее состояние с сохраненным в БД
- Создает записи в таблице message_history при обнаружении изменений

## Как работает кэширование

1. **Первый парсинг чата:**
   - Сохраняются все сообщения в БД
   - Запоминается дата последнего сообщения
   - Создается полный снимок состояния чата

2. **Последующие парсинги:**
   - Проверяется дата последнего сохраненного сообщения
   - Загружаются только новые сообщения после этой даты
   - Старые сообщения не перезагружаются

3. **Обнаружение изменений:**
   - При force_full_scan старые сообщения перепроверяются
   - Изменения фиксируются в таблице message_history
   - Сохраняется история всех редактирований

## Текущие возможности

✅ **Реализовано:**
- Парсинг только новых сообщений (экономия ресурсов)
- Полное сканирование по запросу
- Отслеживание изменений сообщений
- История редактирований в БД
- Автоматическое определение режима

❌ **Не реализовано отдельными режимами:**
- Парсинг только старых непрочитанных сообщений
- Выборочная проверка диапазона дат
- Режим только проверки изменений без новых

## Рекомендации по использованию

1. **Для регулярного обновления:** Используйте стандартный режим - он автоматически загрузит только новые сообщения

2. **Для проверки изменений:** Используйте функцию "Проверить изменения" в веб-интерфейсе или вызовите метод check_for_changes()

3. **Для полной перезагрузки:** Удалите БД или используйте force_full_scan=True

## Отключение AI анализа

В файле config.py параметр `AUTO_CREATE_AI_ANALYSIS` теперь установлен в `False`. 
AI анализ можно запустить вручную через веб-интерфейс или меню программы.